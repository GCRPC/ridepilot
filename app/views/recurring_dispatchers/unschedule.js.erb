<% if @target_trip_ids.any? %>
  <% if @prev_run.present? %>
    var prev_run_id = <%= @prev_run.id %>;
    var trip_ids = <%= @target_trip_ids.to_json.html_safe %>;
    trip_ids.forEach(function(trip_id) {
      $('#run_trips_panel_' + prev_run_id).find('tr[data-trip-id=' + trip_id + ']').remove();
    });
    $('#run_trips_panel_' + prev_run_id).find('span.run_summary').html("<%= j simple_format(recurring_run_summary(@prev_run, @day_of_week)) %>")
    $('#runs_panel table tbody tr[data-run-id=' + prev_run_id + '] td.trips_count').html(<%= @prev_run.reload.weekday_assignments.for_wday(@day_of_week).count%>);
  <% end %>

  <% if @need_to_update_trips_panel %>
    $('#unassigned_trips_panel').replaceWith("<%= j render('recurring_dispatchers/unassigned_trips_panel') %>");
    configure_unassigned_trips_table();
  <% else %>
    $('#unassigned_trips_panel .panel-title').html("<%= j render('recurring_dispatchers/unassigned_trips_panel_title') %>");
  <% end%>
<% end %>