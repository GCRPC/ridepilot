<tr class="trip" data-trip-id=<%=trip.id%>>
  <td>
    <%= link_to(translate_helper("view"), trip_path(trip)) %>
  </td>
  <td>
    <%= format_time_for_listing_day trip.pickup_time %>
  </td>
  <td>
    <%= link_to trip.customer.name, trip.customer, :title => translate_helper("view_customer_record_link_text") %>
  </td>
  <td>
    <% if trip.customer.try(:phone_number_1)%>
      <%= trip.customer.try(:phone_number_1)%>
    <% end%>
    <% if trip.customer.try(:phone_number_2)%>
      <br>
      <%= trip.customer.try(:phone_number_2)%>
    <% end %>
  </td>
  <td>
    <%= trip.is_return? ? translate_helper("return_trip") : translate_helper("outbound_trip") %>
    <% if trip.is_linked? %>
      <br>
      (<%= translate_helper(:linking_to) %>: 
      <% if trip.is_return? %>
        <a href="<%=trip_path(trip.outbound_trip)%>">
          <%= trip.outbound_trip.id %>
        </a>
      <% else %>
        <a href="<%=trip_path(trip.return_trip)%>">
          <%= trip.return_trip.id %>
        </a>
      <% end %>)
    <% end %>
  </td>
  <td>
    <%= trip.pickup_address.try :address_text %>
  </td>
  <td>
    <%= format_time_for_listing trip.pickup_time %>
  </td>
  <td>
    <%= trip.dropoff_address.try :address_text %>
  </td>
  <td>
    <%= format_time_for_listing trip.appointment_time %>
  </td>
  <td>
    <% if trip.run.present? %>
      <%= link_to trip.run_text, run_path(trip.run.id) %>
    <% end %>
  </td>
  <td>
    <% if can? :edit, trip  %>
      <%= form_for trip, url: trip_callback_path(trip), remote: true, method: :patch, html: { class: 'change-trip-callback' } do |f| %>
        <%= f.check_box :customer_informed, :onclick => "$(this).parents('form').submit()" %>
      <% end %>
    <% else %>
      <%= image_tag("tick-circle.png") if trip.customer_informed %>
    <% end %>
  </td>
  <td class="trip_table_result_column">
    <% if can? :edit, trip  %>
      <%= form_for trip, url: trip_change_result_path(trip), remote: true, method: :patch, html: { class: 'change-trip-result' }  do |f| %>
        <%= f.select :trip_result_id, @trip_results,  { :include_blank => true }, {class: 'form-control', :onchange => "$(this).parents('form').submit()"}  %>
      <% end %>
    <% else %>
      <%= display_trip_result(trip.trip_result) %>
    <% end %>
  </td>
</tr>
