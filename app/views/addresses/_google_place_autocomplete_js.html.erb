<script>
  $(document).ready(function() {

    function fillInAddressDetails(form, address) {
      $(form).find('.address_text').val(address.address);
      $(form).find('.address_city').val(address.city);
      $(form).find('.address_state').val(address.state);
      $(form).find('.address_zip').val(address.zip);
      $(form).find('.address_lat').val(address.lat);
      $(form).find('.address_lon').val(address.lon);
    }

    var autocompleteOptions = {
      types: ['geocode'],
      componentRestrictions: { country: 'us' }
    };

    var bounds = <%= (Utility.new.get_provider_bounds(current_provider) || {}).to_json.to_s.html_safe %>;
    if(bounds.hasOwnProperty('min_lat')) {
      autocompleteOptions.bounds = new google.maps.LatLngBounds(
        new google.maps.LatLng(bounds.min_lat, bounds.min_lon),
        new google.maps.LatLng(bounds.max_lat, bounds.max_lon));
    }

    $(".address_search").geocomplete(autocompleteOptions)
      .bind("geocode:result", function(event, result){
        fillInAddressDetails($(this).parents('form'), googlePlaceParser(result));
      });
  });
</script>